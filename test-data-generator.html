<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POD Filter Test Data Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 12px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            text-align: center;
        }

        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        input[type="number"],
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 16px;
            transition: border 0.3s;
        }

        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #10b981;
            color: white;
        }

        .btn-secondary:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        .info-box {
            background: #f0f9ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 4px;
        }

        .info-box h3 {
            color: #333;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .info-box p {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }

        .info-box ul {
            margin-top: 10px;
            padding-left: 20px;
        }

        .info-box li {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .success-message {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
            display: none;
        }

        .success-message.show {
            display: block;
        }

        .success-message p {
            color: #065f46;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“Š POD Filter Test Data Generator</h1>
        <p class="subtitle">Generate sample Excel files for testing the POD Filter component</p>

        <div class="info-box">
            <h3>What This Tool Does:</h3>
            <p>Generates realistic test data that matches your POD Filter requirements:</p>
            <ul>
                <li>Main Excel file with all required columns</li>
                <li>Exclusion file for testing exclusions feature</li>
                <li>Variety of customer types, credit classes, and bill values</li>
                <li>Mix of data that passes and fails filters</li>
            </ul>
        </div>

        <div class="form-group">
            <label for="mainRecords">Number of Main Records:</label>
            <input type="number" id="mainRecords" value="50" min="10" max="1000">
        </div>

        <div class="form-group">
            <label for="excludeRecords">Number of Exclusion Records:</label>
            <input type="number" id="excludeRecords" value="5" min="0" max="100">
        </div>

        <div class="form-group">
            <label for="dataQuality">Data Quality:</label>
            <select id="dataQuality">
                <option value="mixed">Mixed (Realistic - Some pass, some fail)</option>
                <option value="high">High Quality (Most records pass filters)</option>
                <option value="low">Low Quality (Most records fail filters)</option>
            </select>
        </div>

        <button class="btn btn-primary" onclick="generateMainFile()">
            Generate Main Excel File
        </button>

        <button class="btn btn-secondary" onclick="generateExclusionFile()">
            Generate Exclusion File
        </button>

        <div class="success-message" id="successMessage">
            <p>âœ… File generated successfully! Check your downloads folder.</p>
        </div>
    </div>

    <script>
        const customerTypes = [
            "Medium - COPPER",
            "Medium - FTTH",
            "Small - COPPER",    // Will be filtered out
            "Large - FTTH"       // Will be filtered out
        ];

        const productStatuses = [
            "OK (Voice)",
            "OK - Voice",
            "Suspended (Voice)", // Will be filtered out
            "OK (Data)"          // Will be filtered out
        ];

        const creditClasses = ["VIP", "Regular", "Premium", "Standard", "Basic"];

        const segments = [
            "Enterprise â€“ Government Institutions",
            "Enterprise â€“ Large",
            "SME",
            "Wholesales",
            "Retail",
            "Micro Business"
        ];

        const productLabels = ["COPPER", "FTTH", "LTE"];

        const regions = ["Western", "Central", "Southern", "Northern", "Eastern", "North Western", "North Central", "Uva", "Sabaragamuwa"];

        const firstNames = ["Nimal", "Kamal", "Sunil", "Anil", "Chamara", "Saman", "Ruwan", "Prasad", "Dilshan", "Nuwan", 
                          "Sanduni", "Nimali", "Kamala", "Malini", "Chamari", "Samantha", "Kumari", "Dilini", "Nadeeka", "Madhavi"];

        const lastNames = ["Silva", "Fernando", "Perera", "de Silva", "Jayawardena", "Wijesinghe", "Gunawardena", 
                          "Rajapakse", "Bandara", "Dissanayake", "Wickramasinghe", "Rathnayake", "Jayasekara"];

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function getRandomElement(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function generateAccountNumber() {
            return String(getRandomInt(10000000, 99999999));
        }

        function generatePhoneNumber() {
            const prefixes = ["071", "077", "076", "075", "078", "070", "072"];
            return getRandomElement(prefixes) + String(getRandomInt(1000000, 9999999));
        }

        function generateName() {
            return `${getRandomElement(firstNames)} ${getRandomElement(lastNames)}`;
        }

        function showSuccess() {
            const msg = document.getElementById('successMessage');
            msg.classList.add('show');
            setTimeout(() => {
                msg.classList.remove('show');
            }, 3000);
        }

        function generateMainFile() {
            const numRecords = parseInt(document.getElementById('mainRecords').value);
            const quality = document.getElementById('dataQuality').value;

            const data = [];

            for (let i = 0; i < numRecords; i++) {
                let customerType, productStatus, totalOutstanding;

                if (quality === 'high') {
                    // 80% pass filters
                    customerType = Math.random() < 0.8 ? getRandomElement(customerTypes.slice(0, 2)) : getRandomElement(customerTypes);
                    productStatus = Math.random() < 0.8 ? getRandomElement(productStatuses.slice(0, 2)) : getRandomElement(productStatuses);
                    totalOutstanding = Math.random() < 0.8 ? getRandomInt(2500, 15000) : getRandomInt(1000, 2300);
                } else if (quality === 'low') {
                    // 20% pass filters
                    customerType = Math.random() < 0.2 ? getRandomElement(customerTypes.slice(0, 2)) : getRandomElement(customerTypes);
                    productStatus = Math.random() < 0.2 ? getRandomElement(productStatuses.slice(0, 2)) : getRandomElement(productStatuses);
                    totalOutstanding = Math.random() < 0.2 ? getRandomInt(2500, 15000) : getRandomInt(1000, 2300);
                } else {
                    // Mixed - 50% pass filters
                    customerType = Math.random() < 0.5 ? getRandomElement(customerTypes.slice(0, 2)) : getRandomElement(customerTypes);
                    productStatus = Math.random() < 0.5 ? getRandomElement(productStatuses.slice(0, 2)) : getRandomElement(productStatuses);
                    totalOutstanding = Math.random() < 0.5 ? getRandomInt(2500, 15000) : getRandomInt(1000, 2300);
                }

                const lastBillValue = getRandomInt(2000, 12000);
                const arrears = getRandomInt(1000, 15000);
                const creditClass = getRandomElement(creditClasses);
                const segment = getRandomElement(segments);
                const productLabel = customerType.includes('COPPER') ? 'COPPER' : 
                                   customerType.includes('FTTH') ? 'FTTH' : 
                                   getRandomElement(productLabels);

                data.push({
                    "Account Number": generateAccountNumber(),
                    "Name": generateName(),
                    "Customer Type": customerType,
                    "Product Status": productStatus,
                    "Total Outstanding": totalOutstanding,
                    "Credit Class": creditClass,
                    "Last Bill Value": lastBillValue,
                    "SLT SUB SEGMENT": segment,
                    "Product Label": productLabel,
                    "Arrears": arrears,
                    "Region": getRandomElement(regions),
                    "Contact Number": generatePhoneNumber(),
                    "Mobile Contact Tel": generatePhoneNumber(),
                    "Email Address": `customer${i + 1}@example.com`,
                    "Credit Score": getRandomInt(300, 850),
                    "Credit Class Name": creditClass,
                    "Bill Handling Code Name": "Standard",
                    "Account Manager": generateName(),
                    "Sales Person": generateName()
                });
            }

            // Create Excel file
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "POD Report");
            
            XLSX.writeFile(wb, `POD_Main_Report_${numRecords}_records.xlsx`);
            showSuccess();
        }

        function generateExclusionFile() {
            const numRecords = parseInt(document.getElementById('excludeRecords').value);

            if (numRecords === 0) {
                alert('Please set a number greater than 0 for exclusion records.');
                return;
            }

            const data = [];

            for (let i = 0; i < numRecords; i++) {
                data.push({
                    "Account Number": generateAccountNumber()
                });
            }

            // Create Excel file
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Exclusions");
            
            XLSX.writeFile(wb, `POD_Exclusion_List_${numRecords}_records.xlsx`);
            showSuccess();
        }
    </script>
</body>
</html>
